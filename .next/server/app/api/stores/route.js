"use strict";(()=>{var e={};e.id=593,e.ids=[593],e.modules={399:e=>{e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},517:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},2615:e=>{e.exports=require("http")},8791:e=>{e.exports=require("https")},8621:e=>{e.exports=require("punycode")},6162:e=>{e.exports=require("stream")},7360:e=>{e.exports=require("url")},1568:e=>{e.exports=require("zlib")},4171:(e,r,t)=>{t.r(r),t.d(r,{originalPathname:()=>x,patchFetch:()=>m,requestAsyncStorage:()=>l,routeModule:()=>d,serverHooks:()=>h,staticGenerationAsyncStorage:()=>g});var s={};t.r(s),t.d(s,{GET:()=>c,dynamic:()=>u});var o=t(9303),a=t(8716),i=t(3131),n=t(7070),p=t(5662);let u="force-dynamic";async function c(e){try{let{searchParams:r}=new URL(e.url),t=r.get("area"),s=r.get("category"),o=r.get("search"),a=parseInt(r.get("page")||"1"),i=parseInt(r.get("limit")||"20"),u=p.O.from("stores").select("*",{count:"exact"}).eq("is_active",!0);t&&(u=u.eq("area",t)),s&&(u=u.eq("category",s)),o&&(u=u.ilike("name",`%${o}%`));let c=(a-1)*i;u=(u=u.range(c,c+i-1)).order("created_at",{ascending:!1});let{data:d,error:l,count:g}=await u;if(l)return console.error("Database error:",l),n.NextResponse.json({success:!1,error:{code:"DATABASE_ERROR",message:"データベースエラーが発生しました"}},{status:500});let h=g||0;return n.NextResponse.json({success:!0,data:{stores:d||[],pagination:{page:a,limit:i,total:h,totalPages:Math.ceil(h/i)}}})}catch(e){return console.error("API error:",e),n.NextResponse.json({success:!1,error:{code:"INTERNAL_ERROR",message:"内部サーバーエラーが発生しました"}},{status:500})}}let d=new o.AppRouteRouteModule({definition:{kind:a.x.APP_ROUTE,page:"/api/stores/route",pathname:"/api/stores",filename:"route",bundlePath:"app/api/stores/route"},resolvedPagePath:"/Users/ozawaatsushi/Repository/ichidan-dokusho/ichidan-dokusho-stores/app/api/stores/route.ts",nextConfigOutput:"",userland:s}),{requestAsyncStorage:l,staticGenerationAsyncStorage:g,serverHooks:h}=d,x="/api/stores/route";function m(){return(0,i.patchFetch)({serverHooks:h,staticGenerationAsyncStorage:g})}},5662:(e,r,t)=>{t.d(r,{O:()=>i});var s=t(4738);let o=process.env.NEXT_PUBLIC_SUPABASE_URL||"https://placeholder.supabase.co",a=process.env.NEXT_PUBLIC_SUPABASE_ANON_KEY||"placeholder-key",i=(0,s.eI)(o,a)}};var r=require("../../../webpack-runtime.js");r.C(e);var t=e=>r(r.s=e),s=r.X(0,[276,175],()=>t(4171));module.exports=s})();